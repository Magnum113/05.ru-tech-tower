# 05.ru Tech Tower ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–ú–∏–Ω–∏‚Äë–∏–≥—Ä–∞ –≤ —Å—Ç–∏–ª–µ ¬´stacker¬ª: –∏–≥—Ä–æ–∫ —Å—Ç—Ä–æ–∏—Ç –±–∞—à–Ω—é –∏–∑ –∫–æ—Ä–æ–±–æ–∫/—Ç–µ—Ö–Ω–∏–∫–∏. –ß–µ–º –≤—ã—à–µ –±–∞—à–Ω—è, —Ç–µ–º –ª—É—á—à–µ. –ù–∞ –∑–∞–¥–∞–Ω–Ω–æ–π –≤—ã—Å–æ—Ç–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ–º–æ‚Äë—ç–∫—Ä–∞–Ω —Å –∫–æ–¥–æ–º. –ò–≥—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ, —Ä–µ–Ω–¥–µ—Ä ‚Äî Canvas 2D, UI ‚Äî React.

## –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫
1. `npm install`
2. `npm run dev`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–∫–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã)
- `App.tsx` ‚Äî –∫–æ—Ä–Ω–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏–≥—Ä—ã, –≤–≤–æ–¥–æ–º –∏ —Å—á—ë—Ç–æ–º.
- `components/GameCanvas.tsx` ‚Äî –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ `<canvas>`, —Å–æ–∑–¥–∞—ë—Ç `GameEngine`.
- `components/UIOverlay.tsx` ‚Äî –≤—Å–µ —ç–∫—Ä–∞–Ω—ã –ø–æ–≤–µ—Ä—Ö –∏–≥—Ä—ã –∏ HUD.
- `utils/gameEngine.ts` ‚Äî –∏–≥—Ä–æ–≤–æ–π –¥–≤–∏–∂–æ–∫ –∏ —Ä–µ–Ω–¥–µ—Ä.
- `constants.ts` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–≥—Ä—ã, —Ü–≤–µ—Ç–∞, —Å–æ–æ–±—â–µ–Ω–∏—è, —ç–º–æ–¥–∑–∏‚Äë–ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è.
- `types.ts` ‚Äî —Ç–∏–ø—ã –∏ enum —Å–æ—Å—Ç–æ—è–Ω–∏—è.

## –°–æ—Å—Ç–æ—è–Ω–∏—è –∏–≥—Ä—ã (FSM)
–°–æ—Å—Ç–æ—è–Ω–∏—è –æ–ø–∏—Å–∞–Ω—ã –≤ `types.ts`:
- `START` ‚Äî —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω –∏ –æ–±—É—á–µ–Ω–∏–µ.
- `PLAYING` ‚Äî –∞–∫—Ç–∏–≤–Ω–∞—è –∏–≥—Ä–∞.
- `PROMO_PAUSE` ‚Äî –ø–∞—É–∑–∞ –Ω–∞ –ø—Ä–æ–º–æ‚Äë—ç–∫—Ä–∞–Ω–µ.
- `GAME_OVER` ‚Äî —ç–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.

–ü–µ—Ä–µ—Ö–æ–¥—ã:
- `START ‚Üí PLAYING` ‚Äî –∫–Ω–æ–ø–∫–∞ ¬´–ù–∞—á–∞—Ç—å¬ª –∏–ª–∏ –∫–ª–∞–≤–∏—à–∞ `Space`.
- `PLAYING ‚Üí PROMO_PAUSE` ‚Äî –¥–æ—Å—Ç–∏–≥–Ω—É—Ç —É—Ä–æ–≤–µ–Ω—å `promoLevel`.
- `PROMO_PAUSE ‚Üí PLAYING` ‚Äî –∫–Ω–æ–ø–∫–∞ ¬´–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É¬ª.
- `PLAYING ‚Üí GAME_OVER` ‚Äî –ø—Ä–æ–º–∞—Ö (–±–ª–æ–∫ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ –ø–µ—Ä–µ—Å—ë–∫—Å—è).
- `GAME_OVER ‚Üí PLAYING` ‚Äî –∫–Ω–æ–ø–∫–∞ ¬´–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞¬ª –∏–ª–∏ `Space`.

## –≠–∫—Ä–∞–Ω—ã –∏ UI
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ `components/UIOverlay.tsx`:

1. **–°—Ç–∞—Ä—Ç–æ–≤—ã–π —ç–∫—Ä–∞–Ω (START)**
   - –°—é–∂–µ—Ç –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è (–†–∞–º–∞–¥–∞–Ω).
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: —Ç–∞–ø –ø–æ —ç–∫—Ä–∞–Ω—É, —Ç–æ—á–Ω–æ—Å—Ç—å, –∫–æ–º–±–æ.
   - CTA: ¬´–ù–∞—á–∞—Ç—å —Å—Ç—Ä–æ–π–∫—É¬ª.

2. **HUD –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã (PLAYING)**
   - –°–ª–µ–≤–∞: —Ç–µ–∫—É—â–∞—è –≤—ã—Å–æ—Ç–∞ ("–≠—Ç–∞–∂").
   - –°–ø—Ä–∞–≤–∞: –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ("–†–µ–∫–æ—Ä–¥").

3. **–≠–∫—Ä–∞–Ω –ø—Ä–æ–º–æ (PROMO_PAUSE)**
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ (`GAME_CONFIG.promoCode`).
   - –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–∞.
   - –ö–Ω–æ–ø–∫–∞ ¬´–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–≥—Ä—É¬ª.

4. **–≠–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (GAME_OVER)**
   - –î–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞:
     - **–ï—Å–ª–∏ –æ—á–∫–æ–≤ > 0** ‚Äî –±–æ–Ω—É—Å–Ω—ã–π –ø–æ–ø–∞–ø —Å –∏—Ç–æ–≥–∞–º–∏.
     - **–ï—Å–ª–∏ –æ—á–∫–æ–≤ = 0** ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–π —ç–∫—Ä–∞–Ω ¬´–ë–∞—à–Ω—è —É–ø–∞–ª–∞¬ª –∏ –∫–Ω–æ–ø–∫–∞ –ø–æ–≤—Ç–æ—Ä–∞.
   - –ë–µ–π–¥–∂ ¬´–ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥¬ª, –µ—Å–ª–∏ –æ–±–Ω–æ–≤–ª—ë–Ω best.
   - –ö–Ω–æ–ø–∫–∞ ¬´–°—ã–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑¬ª.

## –í–≤–æ–¥ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –ü–ö: –∫–ª–∞–≤–∏—à–∞ `Space`
  - `START`: –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É
  - `PLAYING`: ¬´—Ç–∞–ø¬ª (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–ª–æ–∫–∞)
  - `GAME_OVER`: —Ä–µ—Å—Ç–∞—Ä—Ç
- –ú–æ–±–∏–ª—å–Ω—ã–µ: `pointerdown` –ø–æ —ç–∫—Ä–∞–Ω—É (–≤ —Ä–µ–∂–∏–º–µ `PLAYING`).

## –°—á—ë—Ç –∏ —Ä–µ–∫–æ—Ä–¥—ã
- –°—á—ë—Ç = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤ (—É—Ä–æ–≤–µ–Ω—å/—ç—Ç–∞–∂).
- –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `localStorage` –ø–æ –∫–ª—é—á—É `05ru_tech_tower_best`.
 
## –ë–æ–Ω—É—Å—ã
- –ë–æ–Ω—É—Å—ã –Ω–∞—á–∏—Å–ª—è—é—Ç—Å—è –ø—Ä–∏ `GAME_OVER`, –µ—Å–ª–∏ –∏—Ç–æ–≥–æ–≤—ã–π —Å—á—ë—Ç > 0.
- –§–æ—Ä–º—É–ª–∞: `bonus = min(score, bonusMax)`.
- –ú–∞–∫—Å–∏–º—É–º –±–æ–Ω—É—Å–æ–≤ –∑–∞ –æ–¥–Ω—É –∏–≥—Ä—É: `bonusMax = 1000`.
- –≠–∫—Ä–∞–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç: ¬´–ó–∞–±—Ä–∞—Ç—å –±–æ–Ω—É—Å—ã¬ª –∏–ª–∏ ¬´–°—ã–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑ –∏ –≤–∑—è—Ç—å –±–æ–ª—å—à–µ¬ª.

## –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ (GameEngine)
–ö–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `utils/gameEngine.ts`.

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –°–æ–∑–¥–∞—ë—Ç—Å—è Canvas –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç.
- –ì–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∑–≤—ë–∑–¥—ã –¥–ª—è —Ñ–æ–Ω–∞ (`initStars`).
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ `resize`.
- –ó–∞–ø—É—Å–∫ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ `requestAnimationFrame`‚Äë—Ü–∏–∫–ª–∞.

### –°—Ç–∞—Ä—Ç –∏–≥—Ä—ã (`start()`)
- –û–±–Ω—É–ª–µ–Ω–∏–µ –±–ª–æ–∫–æ–≤, –º—É—Å–æ—Ä–∞, —Ç–µ–∫—Å—Ç–∞.
- –°–±—Ä–æ—Å —Å—á—ë—Ç–∞, —Å–∫–æ—Ä–æ—Å—Ç–∏, –∫–æ–º–±–æ‚Äë—Å–µ—Ä–∏–∏.
- –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –±–ª–æ–∫–∞ –≤–Ω–∏–∑—É.
- –í—ã–∑–æ–≤ `spawnNextBlock()`.

### –°–ø–∞–≤–Ω –±–ª–æ–∫–∞ (`spawnNextBlock()`)
- –ù–æ–≤—ã–π –±–ª–æ–∫ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –Ω–∞ –≤—ã—Å–æ—Ç–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è.
- –®–∏—Ä–∏–Ω–∞ —Ä–∞–≤–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –±–ª–æ–∫—É.
- –ù–∞—á–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è ‚Äî –∑–∞ —ç–∫—Ä–∞–Ω–æ–º —Å–ª–µ–≤–∞ –∏–ª–∏ —Å–ø—Ä–∞–≤–∞ (—Ä–∞–Ω–¥–æ–º).
- –≠–º–æ–¥–∑–∏ –±–ª–æ–∫–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Ä–æ–≤–Ω—è (—Å–º. –Ω–∏–∂–µ).

### –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–ø–∞ (`handleInput()`)
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–º–∞—Ö–∞**
   - –ï—Å–ª–∏ `absDist >= width` ‚Üí `GAME_OVER`.
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ perfect‚Äë–ø–æ–ø–∞–¥–∞–Ω–∏—è**
   - –ï—Å–ª–∏ `absDist <= perfectTolerance`:
     - –ë–ª–æ–∫ –∏–¥–µ–∞–ª—å–Ω–æ —Å–æ–≤–º–µ—â–∞–µ—Ç—Å—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º.
     - –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è `perfectStreak`.
     - –ö–∞–∂–¥—ã–µ `comboThreshold` perfect‚Äë–æ–≤:
       - –ë–ª–æ–∫ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è –Ω–∞ `widthBonus`.
       - –ü–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–µ–∫—Å—Ç ¬´–ë–û–ù–£–° –®–ò–†–ò–ù–´!¬ª.
3. **–û–±—Ä–µ–∑–∫–∞ –ø—Ä–∏ –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏**
   - –ò–∑–ª–∏—à–µ–∫ –æ—Ç—Ä–µ–∑–∞–µ—Ç—Å—è –∏ –ø–∞–¥–∞–µ—Ç –∫–∞–∫ ¬´–º—É—Å–æ—Ä¬ª (`debris`).
   - `perfectStreak` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è.
4. **–§–∏–∫—Å–∞—Ü–∏—è –±–ª–æ–∫–∞**
   - –ë–ª–æ–∫ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ `blocks`.
   - –°—á—ë—Ç —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è.
   - –°–∫–æ—Ä–æ—Å—Ç—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è.
5. **–ü—Ä–æ–º–æ‚Äë—Ç—Ä–∏–≥–≥–µ—Ä**
   - –ï—Å–ª–∏ `score === promoLevel` ‚Üí `PROMO_PAUSE`.
   - –ò–Ω–∞—á–µ ‚Äî —Å–ø–∞–≤–Ω —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–ª–æ–∫–∞.

### –ö–∞–º–µ—Ä–∞
- –ö–∞–º–µ—Ä–∞ –ø–ª–∞–≤–Ω–æ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –∑–∞ –±–∞—à–Ω–µ–π.
- `cameraY` —Ä–∞—Å—Ç—ë—Ç –¥–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ü–µ–ª–∏: `blocks * blockHeight - canvasHeight/2`.

### –†–µ–Ω–¥–µ—Ä
- –§–æ–Ω: –≥—Ä–∞–¥–∏–µ–Ω—Ç —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑.
- –ó–≤—ë–∑–¥—ã: twinkle‚Äë—ç—Ñ—Ñ–µ–∫—Ç —á–µ—Ä–µ–∑ `sin`.
- –ë–ª–æ–∫–∏: –ø—Å–µ–≤–¥–æ‚Äë3D (–≤–µ—Ä—Ö–Ω—è—è –∏ –±–æ–∫–æ–≤–∞—è –≥—Ä–∞–Ω—å).
- –ú—É—Å–æ—Ä: –ø–∞–¥–∞–µ—Ç —Å –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–µ–π –∏ –≤—Ä–∞—â–µ–Ω–∏–µ–º.
- Floating‚Äë—Ç–µ–∫—Å—Ç—ã: –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ perfect‚Äë–∞—Ö.

## –£—Ä–æ–≤–Ω–∏ –∏ —ç–º–æ–¥–∑–∏
–§—É–Ω–∫—Ü–∏—è `getEmojiForLevel(level)`:
- 1‚Äì5: üì±
- 6‚Äì10: üéß
- 11‚Äì15: üíª
- 16‚Äì19: üì∫
- 20+: üïã

–ë–∞–∑–æ–≤—ã–π –±–ª–æ–∫ –≤—Å–µ–≥–¥–∞ üì¶.

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã (`constants.ts`)
- `baseWidth`: –±–∞–∑–æ–≤–∞—è —à–∏—Ä–∏–Ω–∞ –±–ª–æ–∫–∞
- `blockHeight`: –≤—ã—Å–æ—Ç–∞ –±–ª–æ–∫–∞
- `initialSpeed`: –Ω–∞—á–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
- `speedIncrement`: —Ä–æ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –∑–∞ —É—Ä–æ–≤–µ–Ω—å
- `maxSpeed`: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
- `perfectTolerance`: –¥–æ–ø—É—Å–∫ –¥–ª—è ¬´–∏–¥–µ–∞–ª—å–Ω–æ–≥–æ¬ª –ø–æ–ø–∞–¥–∞–Ω–∏—è
- `promoLevel`: –≤—ã—Å–æ—Ç–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–π –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–º–æ‚Äë—ç–∫—Ä–∞–Ω
- `promoCode`: –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–π –ø—Ä–æ–º–æ–∫–æ–¥
- `bonusMax`: –º–∞–∫—Å–∏–º—É–º –±–æ–Ω—É—Å–æ–≤ –∑–∞ –æ–¥–Ω—É –∏–≥—Ä—É
- `comboThreshold`: —Å–µ—Ä–∏—è perfect‚Äë–æ–≤ –¥–ª—è –±–æ–Ω—É—Å–∞
- `widthBonus`: –±–æ–Ω—É—Å–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–ª–æ–∫–∞

## –í–∞–∂–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- Canvas —Ä–∞—Å—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω, UI –ø–æ–≤–µ—Ä—Ö –Ω–µ–≥–æ.
- –ò–≥—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É (–∞–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞), –Ω–æ –ª–æ–≥–∏–∫–∞ –≤–≤–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ `PLAYING`.
- –ü—Ä–æ–º–æ‚Äë—ç–∫—Ä–∞–Ω —Å—Ç–∞–≤–∏—Ç –∏–≥—Ä—É –Ω–∞ –ø–∞—É–∑—É, –Ω–æ –∞–Ω–∏–º–∞—Ü–∏—è —Ñ–æ–Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∏–¥—Ç–∏.
